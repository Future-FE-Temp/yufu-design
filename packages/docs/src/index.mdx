---
name: 组件库文档
route: /
---

import { Playground, Props } from "docz";
import { SketchPicker } from "react-color";
import axios from "axios";
import "../public/style/main.less";

# Yufu Design 开源组件库文档

Hello, I'm a mdx file YY!

# Yufu Design 主题样式切换

<Playground>
  {() => {
    const [radioValue, setRadioValue] = React.useState("1");
    function insertLink(value) {
      setRadioValue(value);
      const heads = document.getElementsByTagName("head");
      const mainLessLink = document.getElementById(`main-less-${value}`);
      if (mainLessLink) {
        heads[0].removeChild(mainLessLink);
      }
      const link = document.createElement("link");
      link.setAttribute("rel", "stylesheet");
      link.setAttribute("type", "text/css");
      link.setAttribute("id", `main-less-${value}`);
      link.setAttribute("href", `../public/style/theme${value}.css`);
      if (heads.length) {
        heads[0].appendChild(link);
      } else {
        document.documentElement.appendChild(link);
      }
    }
    const mainLessLink = document.getElementById("main-less-1");
    if (!mainLessLink) {
      insertLink("1");
    }
    const THEME_OPTIONS = [
      { label: "主题1", value: "1" },
      { label: "主题2", value: "2" },
      { label: "主题3", value: "3" },
    ];
    return (
      <div>
        {THEME_OPTIONS.map((item) => {
          const { label, value } = item;
          return (
            <div key={`theme-option-${value}`}>
              <input
                type="radio"
                checked={value === radioValue}
                onChange={() => {
                  insertLink(value);
                }}
              />
              <span>{label}</span>
            </div>
          );
        })}
      </div>
    );
  }}
</Playground>

<Playground>
  <div className="less-test-wrapper" />
</Playground>

<Playground>
  {() => {
    const [color, setColor] = React.useState("primary");
    const [borderRadius, setBorderRadius] = React.useState("20px");
    const [changedVariable, setChangedVariable] = React.useState({});
    function onDownload() {
      axios.get("/public/style/base.less").then((res) => {
        let styleStr = res.data;
        Object.keys(changedVariable).forEach((v) => {
          const reg = new RegExp(`${v}(.*?)(?=\;)`);
          styleStr = styleStr.replace(reg, `${v}: ${changedVariable[v]}`);
        });
        downloadFromRequest("custom.less", styleStr);
      });
    }
    function downloadFromRequest(fileName, content, onError) {
      let data = "";
      if (content instanceof Blob) {
        data = content;
      }
      if (typeof content === "string") {
        data = new Blob([content]);
      }
      if (
        typeof content == "object" ||
        (typeof content == "object" && content.constructor == Array)
      ) {
        try {
          data = new Blob([JSON.stringify(content)]);
        } catch (e) {
          data = "";
        }
      }
      if (!(data instanceof Blob)) {
        if (_.isFunction(onError)) onError();
        return;
      }
      if (window.navigator.msSaveOrOpenBlob) {
        // for IE and Edge
        window.navigator.msSaveBlob(data, fileName);
      } else {
        const url = window.URL.createObjectURL(data);
        const link = document.createElement("a");
        link.href = url;
        link.setAttribute("download", fileName);
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      }
    }
    function onColorChange(currentColor) {
      setColor(currentColor.hex);
      setChangedVariable({
        ...changedVariable,
        ["@main-theme-color"]: currentColor.hex,
      });
      window.less
        .modifyVars({
          "@main-theme-color": currentColor.hex,
          "@common-border-radius": borderRadius,
        })
        .then(() => {
          console.log("修改theme color成功");
        });
    }
    function onInputChange(e) {
      const value = e.target.value;
      setBorderRadius(`${value}px`);
      setChangedVariable({
        ...changedVariable,
        ["@common-border-radius"]: `${value}px`,
      });
      window.less
        .modifyVars({
          "@common-border-radius": `${value}px`,
          "@main-theme-color": color,
        })
        .then(() => {
          console.log("修改border-radius成功");
        });
    }
    function createLink() {
      const link = document.createElement("link");
      link.setAttribute("rel", "stylesheet/less");
      link.setAttribute("id", "main-less");
      link.setAttribute("href", "../public/style/main.less");
      const heads = document.getElementsByTagName("head");
      if (heads.length) {
        heads[0].appendChild(link);
      } else {
        document.documentElement.appendChild(link);
      }
    }
    const mainLessLink = document.getElementById("main-less");
    if (!mainLessLink) {
      createLink();
    }
    function createScript() {
      const script = document.createElement("script");
      script.setAttribute("type", "text/javascript");
      script.setAttribute(
        "src",
        "https://cdnjs.cloudflare.com/ajax/libs/less.js/2.7.2/less.min.js"
      );
      script.setAttribute("id", "less-min-js");
      const heads = document.getElementsByTagName("head");
      if (heads.length) {
        heads[0].appendChild(script);
      } else {
        document.documentElement.appendChild(script);
      }
    }
    const lessScript = document.getElementById("less-min-js");
    if (!lessScript) {
      createScript();
    }
    return (
      <div>
        <SketchPicker color={color} onChangeComplete={onColorChange} />
        <div style={{ marginTop: "20px" }}>
          <span>修改圆角</span>
          <input type="number" onChange={onInputChange} />
        </div>
        <button onClick={onDownload}>下载自定义样式文件</button>
      </div>
    );
  }}
</Playground>
